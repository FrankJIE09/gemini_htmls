<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>银河财富轨道引擎 - 纳斯达克远航控制台</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --neon-orange: #ff6d00;
            --neon-orange-glow: rgba(255, 109, 0, 0.6);
            --dark-bg: #0a0b0d;
            --console-gray: #1a1c1e;
            --grid-color: rgba(255, 109, 0, 0.05);
        }

        body {
            background-color: var(--dark-bg);
            color: #e0e0e0;
            font-family: 'JetBrains Mono', monospace;
            overflow-x: hidden;
            background-image: 
                linear-gradient(var(--grid-color) 1px, transparent 1px),
                linear-gradient(90deg, var(--grid-color) 1px, transparent 1px);
            background-size: 30px 30px;
        }

        .orbitron { font-family: 'Orbitron', sans-serif; }

        .glass-panel {
            background: rgba(26, 28, 30, 0.8);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 109, 0, 0.2);
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .neon-text {
            color: var(--neon-orange);
            text-shadow: 0 0 8px var(--neon-orange-glow);
        }

        input[type="range"] {
            -webkit-appearance: none;
            width: 100%;
            background: #333;
            height: 4px;
            border-radius: 2px;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 18px;
            width: 18px;
            border-radius: 50%;
            background: var(--neon-orange);
            cursor: pointer;
            box-shadow: 0 0 10px var(--neon-orange);
        }

        .btn-deduce {
            background: transparent;
            border: 1px solid var(--neon-orange);
            color: var(--neon-orange);
            transition: all 0.3s;
            position: relative;
            overflow: hidden;
        }

        .btn-deduce:hover {
            background: var(--neon-orange);
            color: black;
            box-shadow: 0 0 25px var(--neon-orange);
        }

        .scanline {
            width: 100%;
            height: 2px;
            background: rgba(255, 109, 0, 0.1);
            position: absolute;
            top: 0;
            left: 0;
            pointer-events: none;
            animation: scan 4s linear infinite;
        }

        @keyframes scan {
            0% { top: 0; }
            100% { top: 100%; }
        }

        .data-label {
            font-size: 0.7rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            color: #888;
        }

        .visual-bar {
            height: 8px;
            border-radius: 4px;
            transition: width 0.5s ease-out;
        }

        /* 曲线轨迹动画 */
        .trajectory-path {
            stroke-dasharray: 1000;
            stroke-dashoffset: 1000;
            animation: draw 2s ease-out forwards;
        }

        @keyframes draw {
            to { stroke-dashoffset: 0; }
        }

        .glow-point {
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0% { r: 3; opacity: 0.5; }
            50% { r: 6; opacity: 1; }
            100% { r: 3; opacity: 0.5; }
        }
    </style>
</head>
<body class="p-4 md:p-8 min-h-screen flex items-center justify-center">

    <div class="max-w-5xl w-full relative">
        <div class="scanline"></div>

        <!-- Header -->
        <header class="mb-8 text-center md:text-left">
            <h1 class="orbitron text-3xl md:text-5xl font-bold neon-text tracking-tighter uppercase">Galactic Wealth Engine</h1>
            <p class="data-label mt-2">Status: Real-time Trajectory Mapping // Sector: Nasdaq-100 Console</p>
        </header>

        <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
            
            <!-- Left Controls: Inputs -->
            <div class="lg:col-span-4 space-y-6">
                <div class="glass-panel p-6 rounded-sm border-l-4 border-l-[#ff6d00]">
                    <h2 class="orbitron text-xs mb-6 flex items-center tracking-widest text-gray-400">
                        <span class="w-2 h-2 bg-[#ff6d00] inline-block mr-2 animate-pulse"></span>
                        INPUT PARAMETERS
                    </h2>

                    <div class="mb-6">
                        <div class="flex justify-between mb-2">
                            <label class="data-label">初始本金 (P)</label>
                            <span id="p-val-display" class="neon-text">100,000</span>
                        </div>
                        <input type="range" id="input-p" min="0" max="1000000" step="5000" value="100000">
                    </div>

                    <div class="mb-6">
                        <div class="flex justify-between mb-2">
                            <label class="data-label">每月定投 (M)</label>
                            <span id="m-val-display" class="neon-text">5,000</span>
                        </div>
                        <input type="range" id="input-m" min="0" max="50000" step="500" value="5000">
                    </div>

                    <div class="mb-6">
                        <div class="flex justify-between mb-2">
                            <label class="data-label">预期收益率 (r)</label>
                            <span id="r-val-display" class="neon-text">10%</span>
                        </div>
                        <input type="range" id="input-r" min="0" max="30" step="0.5" value="10">
                    </div>

                    <div class="mb-8">
                        <div class="flex justify-between mb-2">
                            <label class="data-label">投资年限 (n)</label>
                            <span id="n-val-display" class="neon-text">20 YR</span>
                        </div>
                        <input type="range" id="input-n" min="1" max="50" step="1" value="20">
                    </div>

                    <button id="btn-deduce" class="btn-deduce w-full py-4 orbitron font-bold text-lg tracking-widest">
                        SIMULATE PATH
                    </button>
                </div>

                <div class="glass-panel p-4 rounded-sm border-l-4 border-l-blue-500">
                    <h3 class="data-label mb-2 text-blue-400">本金威力 (Fixed Deposit Power)</h3>
                    <div class="flex items-end justify-between">
                        <div id="p-power-display" class="text-2xl orbitron text-blue-400">￥0.00</div>
                    </div>
                </div>
            </div>

            <!-- Right Display: Visualizer -->
            <div class="lg:col-span-8 space-y-6">
                <!-- Main Total Display -->
                <div class="glass-panel p-8 rounded-sm relative overflow-hidden">
                    <label class="data-label block mb-2">预估终值 (Trajectory Target)</label>
                    <div id="total-display" class="orbitron text-5xl md:text-7xl font-bold neon-text break-all">
                        ￥0.00
                    </div>

                    <div class="mt-8 grid grid-cols-2 gap-8">
                        <div>
                            <label class="data-label mb-1 block">累计投入成本</label>
                            <div id="cost-display" class="text-xl font-bold text-gray-300">￥0.00</div>
                            <div class="w-full bg-gray-800 mt-2 h-1 rounded-full overflow-hidden">
                                <div id="cost-bar" class="visual-bar bg-gray-500" style="width: 30%"></div>
                            </div>
                        </div>
                        <div>
                            <label class="data-label mb-1 block">预估净收益</label>
                            <div id="profit-display" class="text-xl font-bold text-[#ff6d00]">￥0.00</div>
                            <div class="w-full bg-gray-800 mt-2 h-1 rounded-full overflow-hidden">
                                <div id="profit-bar" class="visual-bar bg-[#ff6d00]" style="width: 70%"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Growth Curve Visualizer -->
                <div class="glass-panel p-6 rounded-sm h-80 relative flex flex-col">
                    <h3 class="data-label mb-4 flex justify-between">
                        <span>财富增长轨道 (Wealth Growth Trajectory)</span>
                        <span class="text-[10px] opacity-50">Logarithmic Simulation</span>
                    </h3>
                    
                    <div class="flex-1 w-full relative" id="chart-wrapper">
                        <!-- SVG Curve Chart -->
                        <svg id="trajectory-chart" class="w-full h-full overflow-visible">
                            <defs>
                                <linearGradient id="area-gradient" x1="0" y1="0" x2="0" y2="1">
                                    <stop offset="0%" stop-color="var(--neon-orange)" stop-opacity="0.3" />
                                    <stop offset="100%" stop-color="var(--neon-orange)" stop-opacity="0" />
                                </linearGradient>
                            </defs>
                            <!-- Grid Lines (Horizontal) -->
                            <g id="grid-lines-h" stroke="rgba(255,255,255,0.05)" stroke-width="1"></g>
                            <!-- Area under curve -->
                            <path id="curve-area" fill="url(#area-gradient)" d=""></path>
                            <!-- The Curve -->
                            <path id="curve-path" fill="none" stroke="var(--neon-orange)" stroke-width="3" stroke-linecap="round" d="" class="trajectory-path"></path>
                            <!-- Interactive Point -->
                            <circle id="end-point" cx="0" cy="0" r="5" fill="var(--neon-orange)" class="glow-point"></circle>
                        </svg>
                    </div>

                    <div class="flex justify-between mt-4 text-[10px] text-gray-500 orbitron tracking-widest">
                        <span>LAUNCH</span>
                        <span id="target-year-label">20 YEARS HORIZON</span>
                    </div>
                </div>
            </div>

        </div>

        <footer class="mt-8 text-[10px] text-gray-600 uppercase tracking-[4px] text-center border-t border-gray-900 pt-4">
            Authorized Personnel Only // Nasdaq Simulation Protocol v4.0
        </footer>
    </div>

    <script>
        const inputs = {
            p: document.getElementById('input-p'),
            m: document.getElementById('input-m'),
            r: document.getElementById('input-r'),
            n: document.getElementById('input-n')
        };

        const displays = {
            p: document.getElementById('p-val-display'),
            m: document.getElementById('m-val-display'),
            r: document.getElementById('r-val-display'),
            n: document.getElementById('n-val-display'),
            total: document.getElementById('total-display'),
            cost: document.getElementById('cost-display'),
            profit: document.getElementById('profit-display'),
            pPower: document.getElementById('p-power-display'),
            costBar: document.getElementById('cost-bar'),
            profitBar: document.getElementById('profit-bar'),
            targetYear: document.getElementById('target-year-label'),
            path: document.getElementById('curve-path'),
            area: document.getElementById('curve-area'),
            point: document.getElementById('end-point'),
            svg: document.getElementById('trajectory-chart'),
            gridH: document.getElementById('grid-lines-h')
        };

        function formatCurrency(num) {
            if (num > 100000000) return '￥' + (num / 100000000).toFixed(2) + ' 亿';
            return '￥' + num.toLocaleString('en-US', { minimumFractionDigits: 0, maximumFractionDigits: 0 });
        }

        function calculate() {
            const P = parseFloat(inputs.p.value);
            const M = parseFloat(inputs.m.value);
            const r = parseFloat(inputs.r.value) / 100;
            const n = parseFloat(inputs.n.value);

            const i = r / 12; 
            const t = n * 12; 
            
            let total = 0;
            if (i === 0) {
                total = P + M * t;
            } else {
                const part1 = P * Math.pow(1 + i, t);
                const part2 = M * ((Math.pow(1 + i, t) - 1) / i) * (1 + i);
                total = part1 + part2;
            }

            const totalCost = P + M * t;
            const netProfit = total - totalCost;
            const pPower = P * Math.pow(1 + 0.10, n);

            return { total, totalCost, netProfit, pPower, n, r, P, M, i };
        }

        function drawCurve(data) {
            const width = displays.svg.clientWidth;
            const height = displays.svg.clientHeight;
            const points = [];
            const steps = 50; 
            
            // 计算点集
            for (let s = 0; s <= steps; s++) {
                const currentYear = (data.n / steps) * s;
                const months = currentYear * 12;
                let val = 0;
                if (data.i === 0) val = data.P + data.M * months;
                else val = data.P * Math.pow(1 + data.i, months) + data.M * ((Math.pow(1 + data.i, months) - 1) / data.i) * (1 + data.i);
                
                const x = (s / steps) * width;
                const y = height - (val / data.total) * height;
                points.push({ x, y });
            }

            // 构建 SVG Path (D 属性)
            let d = `M ${points[0].x} ${points[0].y}`;
            for (let j = 1; j < points.length; j++) {
                d += ` L ${points[j].x} ${points[j].y}`;
            }

            displays.path.setAttribute('d', d);

            // 构建 Area Path
            let areaD = d + ` L ${width} ${height} L 0 ${height} Z`;
            displays.area.setAttribute('d', areaD);

            // 移动终点
            const lastPoint = points[points.length - 1];
            displays.point.setAttribute('cx', lastPoint.x);
            displays.point.setAttribute('cy', lastPoint.y);

            // 绘制水平背景线
            displays.gridH.innerHTML = '';
            for(let i=1; i<4; i++) {
                const lineY = (height / 4) * i;
                const line = document.createElementNS("http://www.w3.org/2000/svg", "line");
                line.setAttribute("x1", 0);
                line.setAttribute("y1", lineY);
                line.setAttribute("x2", width);
                line.setAttribute("y2", lineY);
                displays.gridH.appendChild(line);
            }
        }

        function updateUI() {
            const data = calculate();

            displays.p.textContent = data.P.toLocaleString();
            displays.m.textContent = data.M.toLocaleString();
            displays.r.textContent = (data.r * 100).toFixed(1) + '%';
            displays.n.textContent = data.n + ' YR';
            displays.targetYear.textContent = data.n + ' YEARS HORIZON';

            displays.total.textContent = formatCurrency(data.total);
            displays.cost.textContent = formatCurrency(data.totalCost);
            displays.profit.textContent = formatCurrency(data.netProfit);
            displays.pPower.textContent = formatCurrency(data.pPower);

            const costPercent = (data.totalCost / data.total) * 100;
            displays.costBar.style.width = costPercent + '%';
            displays.profitBar.style.width = (100 - costPercent) + '%';

            drawCurve(data);
        }

        function animateValue(obj, start, end, duration) {
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                const currentVal = progress * (end - start) + start;
                obj.textContent = formatCurrency(currentVal);
                if (progress < 1) window.requestAnimationFrame(step);
            };
            window.requestAnimationFrame(step);
        }

        document.getElementById('btn-deduce').addEventListener('click', () => {
            const data = calculate();
            animateValue(displays.total, 0, data.total, 800);
            animateValue(displays.cost, 0, data.totalCost, 800);
            animateValue(displays.profit, 0, data.netProfit, 800);
            
            // 重新触发曲线绘画动画
            displays.path.style.animation = 'none';
            displays.path.offsetHeight; // trigger reflow
            displays.path.style.animation = 'draw 1.5s ease-out forwards';
        });

        Object.values(inputs).forEach(input => {
            input.addEventListener('input', updateUI);
        });

        // 窗口缩放时重绘曲线
        window.addEventListener('resize', updateUI);

        window.onload = updateUI;
    </script>
</body>
</html>
